name: test_panos_validations
label: test skillet for spot testing select validations
description: test skillet for spot testing select validations
type: pan_validation

# contains checks for device hardening, operational settings, logging, user access

variables:

snippets:

  - name: capture_logging_syslog
    cmd: parse
    variable: config
    outputs:
      - name: shared_log_settings_system_snmptrap
        capture_list: /config/shared/log-settings/system/match-list/entry[filter='All Logs' and send-snmptrap]/@name
      - name: shared_log_settings_config_snmptrap
        capture_list: /config/shared/log-settings/config/match-list/entry[filter='All Logs' and send-snmptrap]/@name
      - name: shared_log_settings_userid_snmptrap
        capture_list: /config/shared/log-settings/userid/match-list/entry[filter='All Logs' and send-snmptrap]/@name
      - name: shared_log_settings_hipmatch_snmptrap
        capture_list: /config/shared/log-settings/hipmatch/match-list/entry[filter='All Logs' and send-snmptrap]/@name
      - name: shared_log_settings_iptag_snmptrap
        capture_list: /config/shared/log-settings/iptag/match-list/entry[filter='All Logs' and send-snmptrap]/@name

  - name: system_logging_configured_snmp
    label: SNMPv3 traps should be configured
    test: |-
      shared_log_settings_system_snmptrap
      and shared_log_settings_config_snmptrap
      and shared_log_settings_userid_snmptrap
      and shared_log_settings_hipmatch_snmptrap
      and shared_log_settings_iptag_snmptrap
    fail_message: |-
      log types violating benchmark requirement:
      {%- if not shared_log_settings_system_snmptrap %}
        System
      {%- endif %}
      {%- if not shared_log_settings_config_snmptrap %}
        Configuration
      {%- endif %}
      {%- if not shared_log_settings_userid_snmptrap %}
        User ID
      {%- endif %}
      {%- if not shared_log_settings_hipmatch_snmptrap %}
        HIP Match
      {%- endif %}
      {%- if not shared_log_settings_iptag_snmptrap %}
        IP Tag
      {%- endif %}
    documentation_link: |-
      https://iron-skillet.readthedocs.io/en/docs_master/cis.html#snmpv3-traps-should-be-configured